\section*{§ 1. Цепи Маркова: основные определения. Матрица переходных вероятностей}

Рассмотрим последовательность случайных величин (с.~в.) $\{X_n\}_{n=0}^{\infty}$,
принимающих значения $E_1, E_2, \ldots$.

\textbf{Определение 1.1.}
Последовательность с.~в. $\{X_n\}_{n=0}^{\infty}$ называется цепью Маркова,
если для произвольного набора
$i_0 < i_1 < \dots < i_{k-1} < i_k$ ($k = 3,4,\ldots$)
и любых $E_{j_1},\ldots,E_{j_k}$ справедливо равенство
\[
	P(X_{i_k}=E_{j_k}\mid X_{i_1}=E_{j_1},\ldots,X_{i_{k-1}}=E_{j_{k-1}})=
	P(X_{i_k}=E_{j_k}\mid X_{i_{k-1}}=E_{j_{k-1}}).
\]

\textbf{Определение 1.2.}
Цепь Маркова $\{X_n\}_{n=0}^{\infty}$ называется однородной,
если для всех $i,j$ вероятности $p_{ij}=P(X_{n+1}=E_j\mid X_n=E_i)$
не зависят от $n$.

В дальнейшем рассматриваются только однородные цепи Маркова.
Вероятности $p_{ij}$ называются переходными,
а матрица $P=\|p_{ij}\|$ называется матрицей переходных вероятностей
цепи Маркова.

Если множество значений (множество состояний) цепи Маркова
$S=\{E_1,E_2,\ldots\}$ конечно, то цепь называется конечной цепью Маркова.
При числе элементов в $S$, равном $N=|S|=\infty$,
цепь называется счётной цепью Маркова.

Матрица переходных вероятностей обладает следующими свойствами:
\begin{enumerate}
	\item $p_{ij} \ge 0$;
	\item $\displaystyle \sum_{j=1}^{N} p_{ij} = 1 \quad \text{для всех } i = 1,2,\ldots,N$.
\end{enumerate}

Матрица, удовлетворяющая свойствам 1) и 2), называется стохастической.

Наряду с матрицей переходных вероятностей будем рассматривать матрицу
вероятностей перехода за $n$ шагов (за время $n$):
\[
	P(n) = \|p_{ij}(n)\|, \qquad
	p_{ij}(n) = P(X_{n+k} = E_j \mid X_k = E_i),
\]
при этом $P(1) = P$ — матрица переходных вероятностей.

Распределение $X_n$ будем представлять вектором
\[
	\vec{\rho}(n) = (\rho_1(n), \rho_2(n), \ldots),
	\qquad
	\rho_i(n) = P(X_n = E_i).
\]
Вектор $\vec{\rho}(0)$ называется начальным распределением цепи Маркова.

\textbf{Теорема 1.1.}
\[
	P(n) = P^n.
\]

Найдём
\[
	P(Y_1 = 1 \mid Y_{-1} = 2)
	= \frac{P(Y_{-1} = 2,\, Y_1 = 1)}{P(Y_{-1} = 2)}.
\]

\[
	P(Y_{-1} = 2,\, Y_1 = 1)
	= P(X_{-1} = 2,\, X_1 = 1)
	= \frac{3}{8}\cdot \frac{3}{8} + \frac{1}{4}\cdot \frac{1}{4}
	= \frac{3}{10},
\]
\[
	P(X_{-1} = 2) + P(X_{-1} = 3)
	= \frac{3}{8} + \frac{1}{4}.
\]

То есть процесс не является цепью Маркова.

Заметим, что необходимые здесь значения $P(X_{-1}=2)$ и $P(X_{-1}=3)$
следует найти из распределения вероятностей через один шаг.
Непосредственно видно:
\[
	\vec{\rho}(1)=\vec{\rho}(0)P=\left(\tfrac{3}{8},\,\tfrac{3}{8},\,\tfrac{1}{4}\right).
\]

\textbf{Замечание 1.1.}
Если матрица переходных вероятностей $\rho_X$
цепи Маркова $\{X_n\}_{n=0}^{\infty}$ удовлетворяет условию
$\rho_{21}=\rho_{31}=\alpha$, то последовательность с.~в.
$\{Y_n\}_{n=0}^{\infty}$ будет цепью Маркова.

Действительно, при всех $i_0,i_1,\dots,i_{n-1},i_n$ имеем
\begin{align*}
	P(Y_n = 1 \mid Y_0 = i_0,\ldots,Y_{n-1}= i_{n-1})
	 & = P(X_n = 1 \mid Y_0 = i_0,\ldots,Y_{n-1}= i_{n-1}) \\
	 & = p_{11}                                            \\
	 & = P(Y_n = 1 \mid Y_{n-1} = 1).
\end{align*}


\begin{align*}
	 & P(Y_n = 2 \mid Y_0 = i_0,\ldots,Y_{n-1}=1)   \\
	 & = P(X_n = 2 \mid Y_0 = i_0,\ldots,Y_{n-1}=1)
	+ P(X_n = 3 \mid Y_0 = i_0,\ldots,Y_{n-1}=1)    \\
	 & = P(X_n = 2 \mid X_{n-1}=1)
	+ P(X_n = 3 \mid X_{n-1}=1)                     \\
	 & = p_{12} + p_{13}
	= 1 - p_{11}
	= P(Y_n = 2 \mid Y_{n-1}=1).
\end{align*}


\begin{align*}
	P(Y_n = 1 \mid Y_0 = i_0,\ldots,Y_{n-1}=2)
	 & = \frac{P(Y_0=i_0,\ldots,Y_{n-1}=2,\,Y_n=1)}
	{P(Y_0=i_0,\ldots,Y_{n-1}=2)}.
\end{align*}


